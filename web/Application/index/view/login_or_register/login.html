<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登录</title>
    <link rel="stylesheet" type="text/css" href="__CSS__/semantic.css" />
    <link rel="stylesheet" type="text/css" href="__CSS__/login.css" />
    <script src="__JS__/jquery-3.3.1.min.js"></script>
    <script src="__STATIC__/layer/layer.js"></script>
</head>

<body>
<div class="header" title="登录">
    <img src="__IMG__/login_logo.png">
</div>

<div class="main">
    <div class="left">
        <div class="login-bg">
            <img src="__IMG__/login_banner.png">
        </div>
    </div>
    <div class="content">
        <!-- 用户输入区开始 -->
        <div class="ui big form">
            <div class="ui stacked segment blue">
                <form id="form" name="form" method="post" action="{:url('checkLogin')}" autocomplete="off">
                    <div class="field">
                        <div class="ui icon input">
                            <i class="user icon"></i>
                            <input id="account" name="account" type="text" placeholder="用户名" autocomplete="off">
                        </div>
                    </div>
                    <div class="field">
                        <div class="ui icon input">
                            <i class="lock icon"></i>
                            <input id="password" name="password" type="password" placeholder="密码" autocomplete="off">
                        </div>
                    </div>
                    <div class="field">
                        <div class="ui icon input">
                            <a> <img class="reloadverify" src="{:url('captcha')}" id="imgcode" onClick="this.src=this.src+'?rand='+Math.random()"
                                     alt="captcha"></a>
                        </div>
                    </div>
                    <div class="field">
                        <div class="ui icon input">
                            <input id="code" name="code" type="text" placeholder="验证码" autocomplete="off">
                        </div>
                    </div>
                    <input type="submit" id="login" value="登录" class="ui fluid large teal submit  button" >
                </form>
            </div>
            <div class="ui message">
                新用户? <a href="{:url('register')}">注册</a>
            </div>
        </div>
        <!-- 推荐输入区结束 -->

        <!-- 推荐用户开始 -->
        <div class="recommend">
            <div class="ui horizontal divider">
                <h4 class="ui teal">推荐学校</h4>
            </div>
            <div class="ui tiny images">
                <img class="ui medium circular image" src="__IMG__/colleges/MIT.png">
                <img class="ui medium circular image" src="__IMG__/colleges/Stanford.png">
                <img class="ui medium circular image" src="__IMG__/colleges/Harvard.png">
                <img class="ui medium circular image" src="__IMG__/colleges/Caltech.png">
                <img class="ui medium circular image" src="__IMG__/colleges/Oxford.png">
                <img class="ui medium circular image" src="__IMG__/colleges/Cambridge.png">
                <img class="ui medium circular image" src="__IMG__/colleges/ETH.png">
                <img class="ui medium circular image" src="__IMG__/colleges/Imperial.png">
                <img class="ui medium circular image" src="__IMG__/colleges/Chicago.png">
            </div>
        </div>
        <!-- 推荐用户结束 -->
    </div>
</div>
<div class="clear"></div>
<div class="footer">
    Copyright@BugAngel
</div>

<!--ajax异步提交-->
<script>
    //检验用户名格式
    function checkname(name) {
        if (name.length < 5 || name.length > 14) {
            layer.msg('用户名格式错误');
            return false;
        }
        return true;
    }

    //检查密码格式
    function checkpassword(password) {
        if (password.length < 6 || password.length > 16) {
            layer.msg("格式错误，密码长度为6-16位");
            return false;
        }
        return true;
    }

    $('form').submit(function () {
        var account = $("input[name='account']").val();
        var password = $("input[name='password']").val();
        var code = $("#code").val();

        if(!checkname(account))
        {
            return false;
        }
        if(!checkpassword(password))
        {
            return false;
        }
        if (!code) {
            layer.msg('验证码不能为空！');
            return false;
        }
        var url = $(this).attr('action');
        var formData = $("#form").serialize();
        $.ajax({
            type: "post",
            url: url,
            dataType: "json",
            data: formData,
            success: function (res) {
                if (res.status) {
                    layer.msg(res.message, {time: 1000}, function () {
                        window.location.href = "{:url('Index/index')}";
                    });
                } else {
                    //刷新验证码
                    $(".reloadverify").click();
                    layer.msg(res.message);
                }
            }
        });
        return false;
    });
</script>
</body>

</html>